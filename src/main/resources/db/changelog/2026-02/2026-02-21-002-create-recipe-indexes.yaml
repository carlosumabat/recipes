databaseChangeLog:
  - changeSet:
      id: 20260221-002-001-create-recipe-title-index
      author: sumabat.johncarlo@gmail.com
      preConditions:
        onFail: MARK_RAN
        and:
          - tableExists:
              tableName: recipe
          - not:
              indexExists:
                tableName: recipe
                indexName: idx_recipe_title
      changes:
        - createIndex:
            tableName: recipe
            indexName: idx_recipe_title
            columns:
              - column:
                  name: title
      rollback:
        - dropIndex:
            tableName: recipe
            indexName: idx_recipe_title

  - changeSet:
      id: 20260221-002-002-create-pg_trgm-extension
      author: sumabat.johncarlo@gmail.com
      changes:
        - sql: |
            CREATE EXTENSION IF NOT EXISTS pg_trgm;
      rollback:

  - changeSet:
      id: 20260221-002-003-create-ingredient-name-index-trigram
      author: sumabat.johncarlo@gmail.com
      preConditions:
        onFail: MARK_RAN
        and:
          - tableExists:
              tableName: recipe
          - not:
              indexExists:
                tableName: recipe
                indexName: idx_ingredient_name_trgm
      changes:
        - sql: |
            CREATE INDEX idx_ingredient_name_trgm
              ON ingredient 
              USING gin ("name" gin_trgm_ops);
      rollback:
        - dropIndex:
            tableName: recipe
            indexName: idx_ingredient_name_trgm
